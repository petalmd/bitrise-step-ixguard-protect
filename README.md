# iXGuard Protect

Protect your iOS archive with iXGuard.

<details>
<summary>Description</summary>

Protect your app archive before export to take advantage of the advanced security features offered by iXGuard.

### Configuring the Step

Before you start:

- You will need to have installed iXGuard to the workspace. This can be done using the Step [Install iXGuard](https://github.com/npinney/bitrise-step-install-ixguard)
- Make sure at the root of your project there can be found a valid `ixguard.yml` configuration file.

To configure the Step:

1. _License Url_: Specifies a url for where the iXGuard license file can be downloaded.
2. _Archive Path_: Specifies the xcarchive that should be protected with iXGuard.

</details>

## üß© Get started

Add this step directly to your workflow in the [Bitrise Workflow Editor](https://devcenter.bitrise.io/steps-and-workflows/steps-and-workflows-index/).

You can also run this step directly with [Bitrise CLI](https://github.com/bitrise-io/bitrise).

### Example

```yaml
workflows:
  example:
    steps:
      - certificate-and-profile-installer@1: {}
      - git::git@github.com:npinney/bitrise-step-install-ixguard.git@main:
          inputs:
            - version: "4.12.2"
      - xcode-archive@5:
          inputs:
            - configuration: Release
            - artifact_name: unprotected
            - xcodebuild_options: -toolchain "com.guardsquare.ixguard"
      - git::git@github.com:npinney/bitrise-step-install-ixguard.git@main: {}
```

## ‚öôÔ∏è Configuration

<details>
<summary>Inputs</summary>

| Key              | Description                                                                                                     | Flags    | Default                             |
| ---------------- | --------------------------------------------------------------------------------------------------------------- | -------- | ----------------------------------- |
| `license_url`    | License file is required when running iXGuard. It is a text file containing permissions for each app bundle ID. | required | `$BITRISEIO_IXGUARD_LICENSE_URL`    |
| `archive_path`   | The built-with-ixguard-toolchain xcarchive path.                                                                | required | `$BITRISE_XCARCHIVE_PATH`           |
| `config_version` | Version of the iXGuard config to use                                                                            | optional | `$BITRISEIO_IXGUARD_CONFIG_VERSION` |

</details>

<details>
<summary>Outputs</summary>

| Environment Variable      | Description                                                                                                                                                                                                                                                            |
| ------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `PROTECTED_ARCHIVE`       | The obfuscated and encrypted .xcarchive file's path.                                                                                                                                                                                                                   |
| `IXGUARD_GENERATED_FILES` | All files generated by ixguard (mapping, log, etc) are compressed into a directory located at this path. When paired with [Deploy to Bitrise.io](https://github.com/bitrise-steplib/steps-deploy-to-bitrise-io) this folder will appear in the artifacts of the build. |

</details>

Learn more about developing steps:

- [Create your own step](https://devcenter.bitrise.io/contributors/create-your-own-step/)
- [Testing your Step](https://devcenter.bitrise.io/contributors/testing-and-versioning-your-steps/)
